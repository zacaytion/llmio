{
  "name": "PollSerializer",
  "source_file": "app/serializers/poll_serializer.rb",
  "inherits_from": "ApplicationSerializer",
  "root_key": "polls",
  "sideloaded_as": "polls",
  "description": "Full poll serializer with voting state and results",
  "attributes": {
    "id": { "type": "integer", "source": "column" },
    "key": { "type": "string", "source": "column" },
    "title": { "type": "string", "source": "column", "discardable": true },
    "poll_type": { "type": "string", "source": "column", "discardable": true },
    "discussion_id": { "type": "integer", "source": "column", "nullable": true },
    "group_id": { "type": "integer", "source": "column", "nullable": true },
    "author_id": { "type": "integer", "source": "column", "discardable": true },
    "details": { "type": "string", "source": "column", "discardable": true },
    "details_format": { "type": "string", "source": "column", "discardable": true, "enum": ["md", "html"] },
    "content_locale": { "type": "string", "source": "column", "discardable": true, "nullable": true },
    "closing_at": { "type": "datetime", "source": "column", "discardable": true, "nullable": true },
    "closed_at": { "type": "datetime", "source": "column", "discardable": true, "nullable": true },
    "created_at": { "type": "datetime", "source": "column", "discardable": true },
    "discarded_at": { "type": "datetime", "source": "column", "nullable": true },
    "discarded_by": { "type": "integer", "source": "column", "nullable": true },
    "anonymous": { "type": "boolean", "source": "column", "discardable": true },
    "can_respond_maybe": { "type": "boolean", "source": "column", "discardable": true },
    "hide_results": { "type": "string", "source": "column", "discardable": true, "enum": ["off", "until_vote", "until_closed"] },
    "notify_on_closing_soon": { "type": "string", "source": "column", "discardable": true },
    "voter_can_add_options": { "type": "boolean", "source": "column", "discardable": true },
    "specified_voters_only": { "type": "boolean", "source": "column", "discardable": true },
    "shuffle_options": { "type": "boolean", "source": "column", "discardable": true },
    "show_none_of_the_above": { "type": "boolean", "source": "column" },
    "chart_type": { "type": "string", "source": "column", "nullable": true },
    "chart_column": { "type": "string", "source": "column", "nullable": true },
    "limit_reason_length": { "type": "integer", "source": "column", "discardable": true },
    "agree_target": { "type": "integer", "source": "column", "nullable": true },
    "reason_prompt": { "type": "string", "source": "column", "nullable": true },
    "stance_reason_required": { "type": "string", "source": "column", "discardable": true, "enum": ["disabled", "optional", "required"] },
    "poll_option_names": { "type": "array", "source": "method", "items": "string", "discardable": true },
    "poll_option_name_format": { "type": "string", "source": "column", "nullable": true },
    "result_columns": { "type": "array", "source": "column", "items": "string", "nullable": true },
    "tags": { "type": "array", "source": "column", "items": "string" },
    "attachments": { "type": "array", "source": "column", "discardable": true, "items": "attachment_object" },
    "link_previews": { "type": "array", "source": "column", "discardable": true, "items": "link_preview_object" },
    "mentioned_usernames": { "type": "array", "source": "column", "discardable": true, "items": "string", "conditional": "details_format == 'md'" },
    "versions_count": { "type": "integer", "source": "column", "discardable": true },
    "voters_count": { "type": "integer", "source": "column", "discardable": true },
    "undecided_voters_count": { "type": "integer", "source": "column", "discardable": true },
    "decided_voters_count": { "type": "integer", "source": "column" },
    "cast_stances_pct": { "type": "integer", "source": "column", "discardable": true },
    "stance_counts": { "type": "array", "source": "column", "discardable": true, "conditional": "poll.show_results?(voted: true)" },
    "total_score": { "type": "integer", "source": "column", "discardable": true },
    "results": { "type": "array", "source": "method", "conditional": "poll.show_results?(voted: true)", "note": "Computed via PollService.calculate_results" },
    "dots_per_person": { "type": "integer", "source": "column", "nullable": true },
    "max_score": { "type": "integer", "source": "column", "nullable": true },
    "min_score": { "type": "integer", "source": "column", "nullable": true },
    "minimum_stance_choices": { "type": "integer", "source": "column", "nullable": true },
    "maximum_stance_choices": { "type": "integer", "source": "column", "nullable": true },
    "meeting_duration": { "type": "integer", "source": "column", "discardable": true, "nullable": true },
    "poll_template_id": { "type": "integer", "source": "column", "nullable": true },
    "poll_template_key": { "type": "string", "source": "column", "nullable": true },
    "quorum_pct": { "type": "integer", "source": "column", "nullable": true },
    "quorum_count": { "type": "integer", "source": "column", "nullable": true },
    "quorum_votes_required": { "type": "integer", "source": "column", "nullable": true }
  },
  "relationships": {
    "discussion": { "serializer": "DiscussionSerializer", "type": "has_one", "root": "discussions", "conditional": "include_type?('discussion')" },
    "created_event": { "serializer": "EventSerializer", "type": "has_one", "root": "events", "conditional": "include_type?('event')" },
    "group": { "serializer": "GroupSerializer", "type": "has_one", "root": "groups", "conditional": "include_type?('group') && object.group_id" },
    "author": { "serializer": "AuthorSerializer", "type": "has_one", "root": "users", "conditional": "include_type?('user') && include_type?('author')" },
    "current_outcome": { "serializer": "OutcomeSerializer", "type": "has_one", "root": "outcomes", "conditional": "include_type?('outcome')" },
    "my_stance": { "serializer": "StanceSerializer", "type": "has_one", "root": "stances", "conditional": "my_stance.present?" },
    "poll_options": { "serializer": "PollOptionSerializer", "type": "has_many", "root": "poll_options", "conditional": "include_type?('poll_option')" }
  },
  "notes": [
    "Most attributes return nil when discarded (extensive hide_when_discarded list)",
    "results computed via PollService.calculate_results based on poll_options",
    "my_stance only included when user has voted"
  ]
}
